#!/bin/bash
#
# This script will install the vim configuration part of the tiborsimon/dotfiles repo. 
# It won't use the symlinked solution as it will create the the .vimrc file and
# the .vim folder instead. It also installs the Vim-Plug plugin manager, and installs the 
# plugins listed in the .vimrc file. 
#
# After the script finished, you will have a full vim configuration on your machine.
#
# This solution is useful if you have spun up a new virtual machine, and you only want to edit 
# files with comfort, and do not want to deploy the whole dotfile system. You won't be able to push
# back changes you make in the config.
#
# Usage: issue the following command on your machine: sh <(curl -fsSL tiborsimon.io/vimrc)

source <(curl -fsSL https://raw.githubusercontent.com/tiborsimon/dotfiles/master/utils/commons)

echo ''
echo '---------------------------------------------------------------------------------'
echo "      T I B O R   S I M O N ' S   V I M   C O N F I G U R A T I O N"
echo '---------------------------------------------------------------------------------'
echo ''

if [ -f ~/.vimrc ] || [ -d ~/.vim ]; then
    while true; do
        warning "Old vim config will be overridden! [${BOLD}${GREEN}D${RESET}]o it, [${BOLD}${GREEN}a${RESET}]bort"
        read -n 1 action

        case "$action" in
            D ) rm -rf $HOME/.vim
                rm -f $HOME/.vimrc
                success "Old vim config deleted."
                break
                ;;
            a ) success 'Bootstrap script aborted.'
                echo ''
                exit
                ;;
            * ) warning 'Wrong answer!'
                ;;
        esac
    done  
fi

# Loading .vimrc file
info 'Downloading .vimrc file..'
curl -fsSL https://raw.githubusercontent.com/tiborsimon/dotfiles/master/vim/vimrc.symlink> ~/.vimrc
success '.vimrc file downloaded.'

# Loading Vim-Plug package manager to the .vim folder
info 'Installing vim-lug..'
curl -sSfLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
success 'Vim-plug installed.'
success "Finished! You may install the plugins by running the command ${BOLD}:Pluginstall${RESET} in vim."
